{"version":3,"sources":["90sec-game.js"],"names":["game","emitter","controller","alignGrid","GameModal","gameDueTime","isPlay","duckMoveSpeed","objSpeed","fireBallTime","isSuperDuck","Controller","on","setDuckMoveSpeed","restartGame","speed","modal","scene","start","uiConfig","canvasBgColor","fontFamily","gridColWidth","gridColHeight","gameTime","window","onload","WebFont","load","google","families","config","type","Phaser","AUTO","width","height","backgroundColor","physics","default","arcade","debug","parent","scale","mode","Scale","FIT","autoCenter","CENTER_BOTH","SceneLoad","SceneStart","Game","progressText","add","text","color","fontSize","setOrigin","onProgress","image","spritesheet","frameWidth","frameHeight","Events","EventEmitter","title","stroke","strokeThickness","shadow","blur","fill","offsetY","duck","sprite","anims","create","key","frames","frame","frameRate","repeat","play","btnStart","FlatButton","x","y","event","startGame","val","setText","Math","floor","Scene","cursors","input","keyboard","createCursorKeys","world","setBounds","cameras","main","gridConfig","rows","cols","AlignGrid","bgMiddle","tileSprite","bgBottom","Wall","origin","bgTop","ballGroup","group","superStarGroup","setCollideWorldBounds","setImmovable","setSize","createTimeBoxCon","placeAt","countDownTimer","time","addEvent","delay","callback","checkCountDownTimer","callbackScope","btnLeft","btnRight","collider","hitTheBall","bind","overlap","hitTheSuperStar","tilePositionY","body","velocity","left","isDown","setFrame","right","boss1","setActive","setVisible","destroy","boss2","children","iterate","ball","star","hitTheBoss","countDueTimer","elapsedTime","minute","second","toString","length","timeText","remove","countDownText","getRepeatCount","checkCountDueTimer","tweens","targets","duration","fireBall","fireSuperStar","fireBoss1","fireBoss2","createGoal","endGame","checkGameTime","becomeSuperTimer","stop","timeBox","graphics","fillStyle","fillRoundedRect","subTimeText","timeBoxCon","container","goal","setScale","opacity","setTimeout","gameOverScreen","GameOverScreen","btnText","gameSuccess","i","alpha","amount","random","getFirstDead","getRandomColumn","setVelocityY","randomDirection","setVelocityX","setBounceX","superStar","subTitle","boss","killSprite","onComplete","checkBecomeSuperTimer","groupName","getChildren","map","child","btn","setInteractive","cursor","onPointerdown","onPointerup","existing","emit","GameObjects","Container","wall","fillRect","clear1","clear2","clear3","btnRestart","row","cw","ch","lineStyle","moveTo","lineTo","strokePath","xx","yy","obj","index","show","count","j","numText","placeAtIndex","min","max"],"mappings":"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","file":"90sec-game.js","sourcesContent":["let game, emitter, controller, alignGrid;\n// store game data\nclass GameModal {\n  constructor() {\n    this.gameDueTime = 0;\n    this.isPlay = false;\n    this.duckMoveSpeed = 150;\n    this.objSpeed = 150;\n    this.fireBallTime = 3;\n    this.isSuperDuck = false;\n  }\n}\n// emitter controler\nclass Controller {\n  constructor() {\n    emitter.on(\"setDuckMoveSpeed\", this.setDuckMoveSpeed);\n    emitter.on(\"restartGame\", this.restartGame);\n  }\n  setDuckMoveSpeed(speed) {\n    modal.duckMoveSpeed = speed;\n  }\n  restartGame() {\n    modal.gameDueTime = 0;\n    modal.isPlay = false;\n    modal.duckMoveSpeed = 150;\n    modal.objSpeed = 100;\n    modal.fireBallTime = 3;\n    modal.isSuperDuck = false;\n    game.scene.start(\"SceneStart\", true);\n  }\n}\nconst modal = new GameModal();\nconst uiConfig = {\n  canvasBgColor: \"0x000000\",\n  fontFamily: \"Roboto, 'Microsoft JhengHei'\",\n  gridColWidth: 75,\n  gridColHeight: 150,\n  gameTime: 90\n};\n\nwindow.onload = function () {\n  WebFont.load({\n    google: {\n      families: [\"Roboto\"]\n    }\n  });\n  // Phaser game config\n  const config = {\n    type: Phaser.AUTO,\n    width: 1200,\n    height: 900,\n    backgroundColor: uiConfig.canvasBgColor,\n    physics: {\n      default: \"arcade\",\n      arcade: {\n        debug: false\n      }\n    },\n    parent: \"game\",\n    scale: {\n      parent: \"game\",\n      mode: Phaser.Scale.FIT,\n      autoCenter: Phaser.Scale.CENTER_BOTH,\n      width: 1200,\n      height: 900\n    },\n    scene: [SceneLoad, SceneStart]\n  };\n\n  game = new Phaser.Game(config);\n};\n\nclass SceneLoad extends Phaser.Scene {\n  constructor() {\n    super(\"SceneLoad\");\n  }\n  preload() {\n    // progress bar event listener\n    this.progressText = this.add.text(\n      game.config.width / 2,\n      game.config.height / 2,\n      \"0%\", {\n        color: \"#ffffff\",\n        fontFamily: uiConfig.fontFamily,\n        fontSize: game.config.width / 40\n      }\n    );\n    this.progressText.setOrigin(0.5);\n    this.load.on(\"progress\", this.onProgress, this);\n    // 場景加載的資源\n    this.load.image(\"bgTop\", \"./img/2nd-week5/bg_top.png\");\n    this.load.image(\"bgMiddle\", \"./img/2nd-week5/bg_middle.png\");\n    this.load.image(\"bgBottom\", \"./img/2nd-week5/bg_bottom.png\");\n    this.load.image(\"boss1\", \"./img/2nd-week5/boss1.png\");\n    this.load.image(\"boss2\", \"./img/2nd-week5/boss2.png\");\n    this.load.image(\"goal\", \"./img/2nd-week5/goal.png\");\n    this.load.image(\"superStar\", \"./img/2nd-week5/superStar.png\");\n    this.load.spritesheet(\"ballSprite\", \"./img/2nd-week5/ball_sprite.png\", {\n      frameWidth: 110,\n      frameHeight: 110\n    });\n    this.load.spritesheet(\"duckSprite\", \"./img/2nd-week5/duck_sprite.png\", {\n      frameWidth: 124,\n      frameHeight: 150\n    });\n    this.load.spritesheet(\n      \"btnLeftSprite\",\n      \"./img/2nd-week5/btnLeft_sprite.png\", {\n        frameWidth: 50,\n        frameHeight: 55\n      }\n    );\n    this.load.spritesheet(\n      \"btnRightSprite\",\n      \"./img/2nd-week5/btnRight_sprite.png\", {\n        frameWidth: 50,\n        frameHeight: 55\n      }\n    );\n    this.load.spritesheet(\"btnStart\", \"./img/2nd-week5/btnStart_sprite.png\", {\n      frameWidth: 150,\n      frameHeight: 55\n    });\n    this.load.spritesheet(\"clearSprite\", \"./img/2nd-week5/clear_sprite.png\", {\n      frameWidth: 190,\n      frameHeight: 155\n    });\n  }\n  create() {\n    // create event emitter\n    emitter = new Phaser.Events.EventEmitter();\n    // create emitter controler\n    controller = new Controller();\n    this.title = this.add.text(\n      game.config.width / 2,\n      game.config.height / 2 - 250,\n      \"90sec Game\", {\n        color: \"#FDD23F\",\n        stroke: \"#F49C24\",\n        strokeThickness: 6,\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 72,\n        shadow: {\n          color: \"#9A7B5D\",\n          blur: 2,\n          fill: true,\n          offsetY: 5\n        }\n      }\n    );\n    this.title.setOrigin(0.5);\n    this.duck = this.add.sprite(\n      game.config.width / 2,\n      game.config.height / 2 - 110,\n      \"duckSprite\"\n    );\n    this.anims.create({\n      key: \"walk\",\n      frames: [{\n        key: \"duckSprite\",\n        frame: 0\n      },\n      {\n        key: \"duckSprite\",\n        frame: 1\n      },\n      {\n        key: \"duckSprite\",\n        frame: 2\n      }\n      ],\n      frameRate: 8,\n      repeat: -1\n    });\n    this.duck.play(\"walk\");\n    this.btnStart = new FlatButton({\n      scene: this,\n      key: \"btnStart\",\n      text: \"開始遊戲\",\n      x: game.config.width / 2,\n      y: game.config.height / 2 + 100,\n      event: \"startGame\"\n    });\n    emitter.on(\"startGame\", this.startGame, this);\n  }\n  onProgress(val) {\n    this.progressText.setText(Math.floor(val * 100) + \"%\");\n  }\n  startGame() {\n    this.scene.start(\"SceneStart\");\n  }\n}\n\nclass SceneStart extends Phaser.Scene {\n  constructor() {\n    super(\"SceneStart\");\n  }\n  init() {\n    this.cursors = this.input.keyboard.createCursorKeys();\n    // 限制邊界在池塘中\n    this.physics.world.setBounds(\n      uiConfig.gridColWidth * 3,\n      - uiConfig.gridColHeight * 5,\n      uiConfig.gridColWidth * 10,\n      uiConfig.gridColHeight * 15\n    );\n    this.cameras.main.setBounds(0, 0, game.config.width, game.config.height);\n  }\n  create() {\n    // gridSystem\n    var gridConfig = {\n      rows: 6,\n      cols: 16,\n      scene: this\n    };\n    alignGrid = new AlignGrid(gridConfig);\n\n    // create game objects\n    this.bgMiddle = this.add.tileSprite(\n      game.config.width / 2,\n      game.config.height / 2,\n      game.config.width,\n      game.config.height,\n      \"bgMiddle\"\n    );\n    this.bgBottom = new Wall({\n      scene: this,\n      x: game.config.width / 2,\n      y: game.config.height - 121,\n      key: \"bgBottom\",\n      origin: {\n        x: 0.5,\n        y: 0\n      }\n    });\n    this.bgTop = new Wall({\n      scene: this,\n      x: game.config.width / 2,\n      y: -121,\n      key: \"bgTop\",\n      origin: {\n        x: 0.5,\n        y: 0\n      }\n    });\n\n    this.ballGroup = this.physics.add.group();\n    this.superStarGroup = this.physics.add.group();\n\n    this.duck = this.physics.add.sprite(\n      game.config.width / 2,\n      game.config.height / 2 - 110,\n      \"duckSprite\"\n    );\n    this.duck.setCollideWorldBounds(true);\n    this.duck.setImmovable(true);\n    this.duck.setSize(60, 120);\n    this.anims.create({\n      key: \"swim\",\n      frames: [{\n        key: \"duckSprite\",\n        frame: 0\n      },\n      {\n        key: \"duckSprite\",\n        frame: 1\n      },\n      {\n        key: \"duckSprite\",\n        frame: 2\n      }\n      ],\n      frameRate: 5,\n      repeat: -1\n    });\n    this.duck.play(\"swim\");\n    this.anims.create({\n      key: \"rush\",\n      frames: [{\n        key: \"duckSprite\",\n        frame: 3\n      },\n      {\n        key: \"duckSprite\",\n        frame: 4\n      },\n      {\n        key: \"duckSprite\",\n        frame: 5\n      }\n      ],\n      frameRate: 8,\n      repeat: -1\n    });\n\n    this.createTimeBoxCon();\n\n    // alignGrid.showNumbers();\n    alignGrid.placeAt(7, 4, this.duck);\n\n    // set Timer\n    this.countDownTimer = this.time.addEvent({\n      delay: 1000,\n      callback: this.checkCountDownTimer,\n      callbackScope: this,\n      repeat: 3\n    });\n\n    this.btnLeft = this.add.sprite(\n      game.config.width - 200,\n      game.config.height - 100,\n      \"btnLeftSprite\"\n    );\n\n    this.btnRight = this.add.sprite(\n      game.config.width - 145,\n      game.config.height - 100,\n      \"btnRightSprite\"\n    );\n\n    this.physics.add.collider(\n      this.ballGroup\n    );\n    this.physics.add.collider(\n      this.duck,\n      this.ballGroup,\n      this.hitTheBall.bind(this)\n    );\n    this.physics.add.collider(\n      this.ballGroup,\n      this.superStarGroup,\n    );\n    this.physics.add.overlap(\n      this.duck,\n      this.superStarGroup,\n      this.hitTheSuperStar.bind(this)\n    );\n  }\n  update() {\n    if (modal.isPlay) {\n      if (modal.isSuperDuck) {\n        this.bgMiddle.tilePositionY -= 0.02 * modal.objSpeed;\n      } else {\n        this.bgMiddle.tilePositionY -= 0.005 * modal.objSpeed;\n      }\n      this.duck.body.velocity.x = 0;\n      if (this.cursors.left.isDown) {\n        this.duck.body.velocity.x = -modal.duckMoveSpeed;\n        this.btnLeft.setFrame(1);\n        this.btnLeft.y = game.config.height - 95;\n      } else if (this.cursors.right.isDown) {\n        this.duck.body.velocity.x = modal.duckMoveSpeed;\n        this.btnRight.setFrame(1);\n        this.btnRight.y = game.config.height - 95;\n      } else {\n        this.btnLeft.setFrame(0);\n        this.btnRight.setFrame(0);\n        this.btnLeft.y = game.config.height - 100;\n        this.btnRight.y = game.config.height - 100;\n      }\n      if (\n        this.boss1 &&\n        this.boss1.y > game.config.height + this.boss1.height / 2\n      ) {\n        this.boss1.setActive(false);\n        this.boss1.setVisible(false);\n        this.boss1.destroy();\n      }\n      if (\n        this.boss2 &&\n        this.boss2.y > game.config.height + this.boss2.height / 2\n      ) {\n        this.boss2.setActive(false);\n        this.boss2.setVisible(false);\n        this.boss2.destroy();\n      }\n      this.ballGroup.children.iterate(function (ball) {\n        if (ball && ball.y > game.config.height + ball.height / 2) {\n          ball.setActive(false);\n          ball.setVisible(false);\n          ball.destroy();\n        }\n      }, this);\n      this.superStarGroup.children.iterate(function (star) {\n        if (star && star.y > game.config.height + star.height / 2) {\n          star.setActive(false);\n          star.setVisible(false);\n          star.destroy();\n        }\n      }, this);\n\n      // physics collider\n      this.physics.add.collider(\n        this.ballGroup,\n        this.boss1,\n      );\n      this.physics.add.collider(\n        this.ballGroup,\n        this.boss2,\n      );\n      this.physics.add.collider(\n        this.duck,\n        this.boss1,\n        this.hitTheBoss.bind(this)\n      );\n      this.physics.add.collider(\n        this.duck,\n        this.boss2,\n        this.hitTheBoss.bind(this)\n      );\n    }\n  }\n  checkGameTime() {\n    if (this.countDueTimer) {\n      const elapsedTime = uiConfig.gameTime - modal.gameDueTime;\n      if (elapsedTime >= 0) {\n        let minute = \"0\" + Math.floor(elapsedTime / 60);\n        let second = (elapsedTime - minute * 60).toString();\n        second = second.length === 2 ? second : \"0\" + second;\n        this.timeText.setText(`${minute}:${second}`);\n      } else {\n        this.countDueTimer.remove();\n        modal.isPlay = false;\n      }\n    }\n  }\n  checkCountDownTimer() {\n    if (this.countDownText) {\n      this.countDownText.destroy();\n    }\n    this.countDownText = this.add.text(\n      game.config.width / 2,\n      game.config.height / 2,\n      this.countDownTimer.getRepeatCount(), {\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 150\n      }\n    );\n    this.countDownText.setOrigin(0.5);\n    if (this.countDownTimer.getRepeatCount() === 0) {\n      this.countDownText.destroy();\n      this.countDueTimer = this.time.addEvent({\n        delay: 1000,\n        callback: this.checkCountDueTimer,\n        callbackScope: this,\n        repeat: uiConfig.gameTime\n      });\n      modal.isPlay = true;\n      this.tweens.add({\n        targets: this.bgBottom,\n        duration: 1000,\n        y: game.config.height\n      });\n      this.fireBall();\n    }\n  }\n  checkCountDueTimer() {\n    if (modal.isPlay) {\n      // console.log(this.ballGroup.getChildren());\n      modal.gameDueTime++;\n      if (modal.gameDueTime % 20 === 0) {\n        modal.objSpeed += 50;\n      }\n      if (\n        modal.gameDueTime % modal.fireBallTime === 0 &&\n        modal.gameDueTime < 80\n      ) {\n        this.fireBall();\n      }\n      if (modal.gameDueTime % 10 === 0 && modal.gameDueTime < 85) {\n        this.fireSuperStar();\n      }\n      if (modal.gameDueTime === 30) {\n        modal.fireBallTime = 2;\n      }\n      if (modal.gameDueTime === 50) {\n        this.fireBoss1();\n      }\n      if (modal.gameDueTime === 60) {\n        modal.fireBallTime = 1;\n      }\n      if (modal.gameDueTime === 82) {\n        this.fireBoss2();\n      }\n      if (modal.gameDueTime === uiConfig.gameTime) {\n        this.tweens.add({\n          targets: this.bgTop,\n          duration: 1000,\n          y: 0\n        });\n        this.createGoal();\n        this.endGame();\n      }\n      this.checkGameTime();\n    }\n  }\n  checkBecomeSuperTimer() {\n    if (this.becomeSuperTimer.getRepeatCount() === 0) {\n      this.duck.anims.stop();\n      this.duck.play(\"swim\");\n      modal.isSuperDuck = false;\n      modal.duckMoveSpeed = 150;\n    }\n  }\n  createTimeBoxCon() {\n    this.timeBox = this.add.graphics();\n    this.timeBox.fillStyle(0x535353);\n    this.timeBox.fillRoundedRect(\n      0,\n      10,\n      uiConfig.gridColWidth * 3,\n      uiConfig.gridColHeight,\n      30\n    );\n    this.timeBox.fillStyle(0x000000);\n    this.timeBox.fillRoundedRect(\n      0,\n      0,\n      uiConfig.gridColWidth * 3,\n      uiConfig.gridColHeight,\n      30\n    );\n    this.subTimeText = this.add.text(uiConfig.gridColWidth / 2, 40, \"TIME\", {\n      fontFamily: uiConfig.fontFamily,\n      fontSize: 20\n    });\n    this.timeText = this.add.text(\n      uiConfig.gridColWidth + uiConfig.gridColWidth / 2,\n      uiConfig.gridColHeight - 50,\n      \"01:30\", {\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 60\n      }\n    );\n    this.timeText.setOrigin(0.5);\n    this.timeBoxCon = this.add.container();\n    this.timeBoxCon.add(this.timeBox);\n    this.timeBoxCon.add(this.subTimeText);\n    this.timeBoxCon.add(this.timeText);\n    this.timeBoxCon.x = uiConfig.gridColWidth * 13;\n    this.timeBoxCon.y = -20;\n  }\n  createGoal() {\n    this.goal = this.add.image(0, 0, \"goal\");\n    alignGrid.placeAt(8, 1, this.goal);\n    this.goal.setScale(0);\n    this.goal.opacity = 0;\n    this.tweens.add({\n      targets: this.goal,\n      duration: 1000,\n      delay: 1000,\n      scale: 1,\n      opacity: 1\n    });\n  }\n  endGame() {\n    if (modal.isPlay) {\n      this.tweens.add({\n        targets: this.duck,\n        duration: 1500,\n        delay: 2000,\n        x: 650,\n        y: 370\n      });\n      setTimeout(() => {\n        this.gameOverScreen = new GameOverScreen({\n          scene: this,\n          x: game.config.width / 2,\n          y: game.config.height / 2,\n          title: \"Congratulations! 恭喜過關!\",\n          btnText: \"再來一次..\",\n          gameSuccess: true\n        });\n        for (let i = 1; i <= 3; i++) {\n          this.tweens.add({\n            targets: this.gameOverScreen[`clear${i}`],\n            duration: 1500,\n            delay: i * 500,\n            alpha: 1\n          });\n        }\n      }, 4200);\n    }\n  }\n  fireBall() {\n    let amount = Math.floor(Math.random() * 3 + 1);\n    for (let i = 0; i < amount; i++) {\n      let ball = this.ballGroup.getFirstDead(false);\n      if (!ball) {\n        ball = this.ballGroup.create(0, 0, \"ballSprite\");\n      }\n      alignGrid.placeAt(getRandomColumn(3, 10), 0, ball);\n      ball.y = -ball.height;\n      ball.setSize(90, 90);\n      ball.setScale(0.7);\n      ball.setCollideWorldBounds(true);\n      ball.setFrame(Math.floor(Math.random() * 4));\n      ball.setActive(true);\n      ball.setVisible(true);\n      ball.setVelocityY(modal.objSpeed);\n      if (modal.gameDueTime > 60) {\n        const randomDirection = Math.random() < 0.5;\n        ball.setVelocityX(randomDirection ? modal.objSpeed / 2 : -modal.objSpeed / 2);\n        ball.setBounceX(0.5);\n      }\n    }\n  }\n  fireBoss1() {\n    this.boss1 = this.physics.add.sprite(0, 0, \"boss1\");\n    alignGrid.placeAt(getRandomColumn(4, 7), 0, this.boss1);\n    this.boss1.y = -this.boss1.height;\n    this.boss1.setSize(350, 250);\n    this.boss1.setActive(true);\n    this.boss1.setVisible(true);\n    this.boss1.setCollideWorldBounds(true);\n    this.boss1.setVelocityY(modal.objSpeed * 0.8);\n  }\n  fireBoss2() {\n    this.boss2 = this.physics.add.sprite(0, 0, \"boss2\");\n    alignGrid.placeAt(getRandomColumn(5, 5), 0, this.boss2);\n    this.boss2.y = -this.boss2.height;\n    this.boss2.setSize(550, 300);\n    this.boss2.setScale(0.9);\n    this.boss2.setActive(true);\n    this.boss2.setVisible(true);\n    this.boss2.setCollideWorldBounds(true);\n    this.boss2.setVelocityY(modal.objSpeed * 0.8);\n  }\n  fireSuperStar() {\n    let superStar = this.superStarGroup.getFirstDead(false);\n    if (!superStar) {\n      superStar = this.superStarGroup.create(0, 0, \"superStar\");\n    }\n    alignGrid.placeAt(getRandomColumn(3, 10), 0, superStar);\n    superStar.y = -superStar.height;\n    superStar.setSize(70, 70);\n    superStar.setActive(true);\n    superStar.setVisible(true);\n    superStar.setVelocityY(modal.objSpeed * 0.6);\n  }\n  hitTheBall(duck, ball) {\n    if (modal.isPlay) {\n      modal.isPlay = false;\n      this.ballGroup.setVelocityY(0);\n      this.superStarGroup.setVelocityY(0);\n      if (this.boss1 && this.boss1.body) {\n        this.boss1.setVelocityY(0);\n      }\n      if (this.boss2 && this.boss2.body) {\n        this.boss2.setVelocityY(0);\n      }\n      this.duck.anims.stop();\n      this.duck.setFrame(6);\n      duck.body.velocity.x = 0;\n      this.gameOverScreen = new GameOverScreen({\n        scene: this,\n        x: game.config.width / 2,\n        y: game.config.height / 2,\n        title: \"UH-OH! 觸礁了\",\n        subTitle: \"勝敗乃鴨家常事，大俠重新來過吧~\",\n        btnText: \"重新挑戰\",\n        gameSuccess: false\n      });\n    }\n  }\n  hitTheBoss(duck, boss) {\n    if (modal.isPlay) {\n      modal.isPlay = false;\n      boss.setVelocityY(0);\n      this.ballGroup.setVelocityY(0);\n      this.superStarGroup.setVelocityY(0);\n      this.duck.anims.stop();\n      this.duck.setFrame(6);\n      duck.body.velocity.x = 0;\n      this.gameOverScreen = new GameOverScreen({\n        scene: this,\n        x: game.config.width / 2,\n        y: game.config.height / 2,\n        title: \"UH-OH! 觸礁了\",\n        subTitle: \"勝敗乃鴨家常事，大俠重新來過吧~\",\n        btnText: \"重新挑戰\",\n        gameSuccess: false\n      });\n    }\n  }\n  hitTheSuperStar(duck, star) {\n    if (modal.isPlay) {\n      this.duck.anims.stop();\n      this.duck.play(\"rush\");\n      modal.duckMoveSpeed = 300;\n      modal.isSuperDuck = true;\n      this.killSprite(\"ballGroup\");\n      this.killSprite(\"superStarGroup\");\n      if (this.boss1) {\n        this.tweens.add({\n          targets: this.boss1,\n          duration: 500,\n          alpha: 0,\n          onComplete: () => {\n            this.boss1.body = null;\n            this.boss1.destroy();\n          }\n        });\n      }\n      if (this.boss2) {\n        this.tweens.add({\n          targets: this.boss2,\n          duration: 500,\n          alpha: 0,\n          onComplete: () => {\n            this.boss2.body = null;\n            this.boss2.destroy();\n          }\n        });\n      }\n      this.becomeSuperTimer = this.time.addEvent({\n        delay: 1000,\n        callback: this.checkBecomeSuperTimer,\n        callbackScope: this,\n        repeat: 3\n      });\n    }\n  }\n  killSprite(groupName) {\n    this[groupName].getChildren().map(child => child.destroy());\n  }\n}\n\n// btn class\nclass FlatButton extends Phaser.GameObjects.Container {\n  constructor(config) {\n    if (!config.scene) {\n      return;\n    }\n    super(config.scene);\n    this.scene = config.scene;\n    this.config = config;\n    this.btn = this.scene.add.sprite(0, 0, config.key);\n    this.add(this.btn);\n    if (config.text) {\n      this.text = this.scene.add.text(0, 0, config.text, {\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 30\n      });\n      this.text.setOrigin(0.5);\n      this.add(this.text);\n    }\n    if (config.x) {\n      this.x = config.x;\n    }\n    if (config.y) {\n      this.y = config.y;\n    }\n    if (config.event) {\n      this.btn.setInteractive({\n        cursor: \"pointer\"\n      });\n      this.btn.on(\"pointerdown\", this.onPointerdown, this);\n      this.btn.on(\"pointerup\", this.onPointerup, this);\n    }\n    this.scene.add.existing(this);\n  }\n  onPointerdown() {\n    this.btn.setFrame(1);\n    this.y += 5;\n  }\n  onPointerup() {\n    this.btn.setFrame(0);\n    this.y -= 5;\n    emitter.emit(this.config.event);\n  }\n}\n\n// wall class\nclass Wall extends Phaser.GameObjects.Container {\n  constructor(config) {\n    if (!config.scene) {\n      return;\n    }\n    super(config.scene);\n    this.scene = config.scene;\n    this.config = config;\n    this.wall = this.scene.add.image(0, 0, config.key);\n    this.graphics = this.scene.add.graphics();\n    this.graphics.fillStyle(0x000000);\n    this.graphics.fillRect(\n      -game.config.width,\n      0,\n      game.config.width + game.config.width / 2,\n      121\n    );\n    this.add(this.graphics);\n    this.add(this.wall);\n    if (config.x) {\n      this.x = config.x;\n    }\n    if (config.y) {\n      this.y = config.y;\n    }\n    if (config.origin) {\n      const {\n        x,\n        y\n      } = config.origin;\n      this.wall.setOrigin(x, y);\n    }\n    this.scene.add.existing(this);\n  }\n  onPointerdown() {\n    this.btn.setFrame(1);\n    this.y += 5;\n  }\n  onPointerup() {\n    this.btn.setFrame(0);\n    emitter.emit(this.config.event);\n  }\n}\n\n// gameOver class\nclass GameOverScreen extends Phaser.GameObjects.Container {\n  constructor(config) {\n    if (!config.scene) {\n      return;\n    }\n    super(config.scene);\n    this.scene = config.scene;\n    this.config = config;\n    this.graphics = this.scene.add.graphics();\n    this.graphics.fillStyle(0x000000, 0.5);\n    this.graphics.fillRect(\n      -game.config.width / 2,\n      -game.config.height / 2,\n      game.config.width,\n      game.config.height\n    );\n    this.graphics.fillStyle(0xffffff);\n    this.graphics.fillRoundedRect(\n      0 - uiConfig.gridColWidth * 4,\n      0 - uiConfig.gridColHeight,\n      uiConfig.gridColWidth * 8,\n      uiConfig.gridColHeight * 2,\n      30\n    );\n    this.add(this.graphics);\n    if (config.gameSuccess) {\n      this.title = this.scene.add.text(0, -110, config.title, {\n        color: \"#ff952b\",\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 36\n      });\n    } else {\n      this.title = this.scene.add.text(0, -60, config.title, {\n        color: \"#ff952b\",\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 36\n      });\n    }\n    this.title.setOrigin(0.5);\n    this.add(this.title);\n    if (config.gameSuccess) {\n      this.clear1 = this.scene.add.sprite(-200, 0, \"clearSprite\", 0);\n      this.clear2 = this.scene.add.sprite(0, 0, \"clearSprite\", 1);\n      this.clear3 = this.scene.add.sprite(200, 0, \"clearSprite\", 2);\n      this.clear1.alpha = 0;\n      this.clear2.alpha = 0;\n      this.clear3.alpha = 0;\n      this.add(this.clear1);\n      this.add(this.clear2);\n      this.add(this.clear3);\n    } else {\n      this.subTitle = this.scene.add.text(0, -10, config.subTitle, {\n        color: \"#707070\",\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 20\n      });\n      this.subTitle.setOrigin(0.5);\n      this.add(this.subTitle);\n    }\n    if (config.gameSuccess) {\n      this.btnRestart = new FlatButton({\n        scene: config.scene,\n        key: \"btnStart\",\n        text: config.btnText,\n        x: 0,\n        y: 110,\n        event: \"restartGame\"\n      });\n    } else {\n      this.btnRestart = new FlatButton({\n        scene: config.scene,\n        key: \"btnStart\",\n        text: config.btnText,\n        x: 0,\n        y: 50,\n        event: \"restartGame\"\n      });\n    }\n    this.add(this.btnRestart);\n    if (config.x) {\n      this.x = config.x;\n    }\n    if (config.y) {\n      this.y = config.y;\n    }\n    this.scene.add.existing(this);\n  }\n  onPointerdown() {\n    this.btn.setFrame(1);\n    this.y += 5;\n  }\n  onPointerup() {\n    this.btn.setFrame(0);\n    emitter.emit(this.config.event);\n  }\n}\n\n// gridSystem\nclass AlignGrid {\n  constructor(config) {\n    if (!config.scene) {\n      return;\n    }\n    this.config = config;\n    this.config.row = config.rows || 6;\n    this.config.cols = config.cols || 5;\n    this.config.width = config.width || game.config.width;\n    this.config.height = config.height || game.config.height;\n\n    this.scene = config.scene;\n    this.cw = this.config.width / this.config.cols;\n    this.ch = this.config.height / this.config.rows;\n  }\n  show() {\n    this.graphics = this.scene.add.graphics();\n    this.graphics.lineStyle(2, 0x00ff00);\n    for (let i = 0; i < this.config.width; i += this.cw) {\n      this.graphics.moveTo(i, 0);\n      this.graphics.lineTo(i, this.config.height);\n    }\n    for (let i = 0; i < this.config.height; i += this.ch) {\n      this.graphics.moveTo(0, i);\n      this.graphics.lineTo(this.config.width, i);\n    }\n    this.graphics.strokePath();\n  }\n  placeAt(xx, yy, obj) {\n    obj.x = this.cw * xx + this.cw / 2;\n    obj.y = this.ch * yy + this.ch / 2;\n  }\n  placeAtIndex(index, obj) {\n    // 另一種指定位置的方式，以格數來指定\n    var xx = index % this.cols;\n    var yy = Math.floor(index / this.cols);\n    this.placeAt(xx, yy, obj);\n  }\n  showNumbers() {\n    // 在每一格中呈現當前的 index 數字\n    this.show();\n    var count = 0;\n    for (var i = 0; i < this.config.rows; i++) {\n      for (var j = 0; j < this.config.cols; j++) {\n        var numText = this.scene.add.text(0, 0, count, \"#00ff00\");\n        numText.setOrigin(0.5, 0.5);\n        this.placeAtIndex(count, numText);\n        count++;\n      }\n    }\n  }\n}\n\nfunction getRandomColumn(min, max) {\n  return Math.floor(Math.random() * max) + min;\n}"]}