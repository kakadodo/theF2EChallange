{"version":3,"sources":["90sec-game.js"],"names":["game","emitter","controller","alignGrid","GameModal","gameDueTime","isPlay","duckMoveSpeed","objSpeed","fireBallTime","Controller","on","setDuckMoveSpeed","restartGame","speed","modal","scene","start","uiConfig","canvasBgColor","fontFamily","gridColWidth","gridColHeight","gameTime","window","onload","WebFont","load","google","families","config","type","Phaser","AUTO","width","height","backgroundColor","physics","default","arcade","debug","parent","scale","mode","Scale","FIT","autoCenter","CENTER_BOTH","SceneLoad","SceneStart","Game","progressText","add","text","color","fontSize","setOrigin","onProgress","image","spritesheet","frameWidth","frameHeight","Events","EventEmitter","title","stroke","strokeThickness","shadow","blur","fill","offsetY","duck","sprite","anims","create","key","frames","frame","frameRate","repeat","play","btnStart","FlatButton","x","y","event","startGame","val","setText","Math","floor","Scene","cursors","input","keyboard","createCursorKeys","world","setBounds","cameras","main","gridConfig","rows","cols","AlignGrid","bgMiddle","bgBottom","Wall","origin","bgTop","ballGroup","group","superStarGroup","setCollideWorldBounds","createTimeBoxCon","placeAt","countDownTimer","time","addEvent","delay","callback","checkCountDownTimer","callbackScope","btnLeft","btnRight","body","velocity","left","isDown","setFrame","right","boss1","setActive","setVisible","destroy","boss2","children","iterate","ball","star","collider","hitTheBall","bind","hitTheBoss","overlap","hitTheSuperStar","countDueTimer","elapsedTime","minute","second","toString","length","timeText","remove","countDownText","getRepeatCount","checkCountDueTimer","tweens","targets","duration","fireBall","fireSuperStar","fireBoss1","fireBoss2","endGame","checkGameTime","becomeSuperTimer","stop","timeBox","graphics","fillStyle","fillRoundedRect","subTimeText","timeBoxCon","container","goal","setScale","opacity","setTimeout","gameOverScreen","GameOverScreen","btnText","gameSuccess","i","alpha","getFirstDead","getRandomColumn","setImmovable","random","setVelocityY","superStar","subTitle","boss","killSprite","checkBecomeSuperTimer","groupName","getChildren","map","child","btn","setInteractive","cursor","onPointerdown","onPointerup","existing","emit","GameObjects","Container","wall","fillRect","clear1","clear2","clear3","btnRestart","row","cw","ch","lineStyle","moveTo","lineTo","strokePath","xx","yy","obj","index","show","count","j","numText","placeAtIndex"],"mappings":"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","file":"90sec-game.js","sourcesContent":["let game, emitter, controller, alignGrid;\n// store game data\nclass GameModal {\n  constructor() {\n    this.gameDueTime = 0;\n    this.isPlay = false;\n    this.duckMoveSpeed = 150;\n    this.objSpeed = 100;\n    this.fireBallTime = 3;\n  }\n}\n// emitter controler\nclass Controller {\n  constructor() {\n    emitter.on(\"setDuckMoveSpeed\", this.setDuckMoveSpeed);\n    emitter.on(\"restartGame\", this.restartGame);\n  }\n  setDuckMoveSpeed(speed) {\n    modal.duckMoveSpeed = speed;\n  }\n  restartGame() {\n    modal.gameDueTime = 0;\n    modal.isPlay = false;\n    modal.duckMoveSpeed = 150;\n    modal.objSpeed = 100;\n    modal.fireBallTime = 3;\n    game.scene.start(\"SceneStart\", true);\n  }\n}\nconst modal = new GameModal();\nconst uiConfig = {\n  canvasBgColor: \"0x000000\",\n  fontFamily: \"Roboto, 'Microsoft JhengHei'\",\n  gridColWidth: 75,\n  gridColHeight: 150,\n  gameTime: 90\n};\n\nwindow.onload = function() {\n  WebFont.load({\n    google: {\n      families: [\"Roboto\"]\n    }\n  });\n  // Phaser game config\n  const config = {\n    type: Phaser.AUTO,\n    width: 1200,\n    height: 900,\n    backgroundColor: uiConfig.canvasBgColor,\n    physics: {\n      default: \"arcade\",\n      arcade: {\n        debug: false\n      }\n    },\n    parent: \"game\",\n    scale: {\n      parent: \"game\",\n      mode: Phaser.Scale.FIT,\n      autoCenter: Phaser.Scale.CENTER_BOTH,\n      width: 1200,\n      height: 900\n    },\n    scene: [SceneLoad, SceneStart]\n  };\n\n  game = new Phaser.Game(config);\n};\n\nclass SceneLoad extends Phaser.Scene {\n  constructor() {\n    super(\"SceneLoad\");\n  }\n  preload() {\n    // progress bar event listener\n    this.progressText = this.add.text(\n      game.config.width / 2,\n      game.config.height / 2,\n      \"0%\",\n      {\n        color: \"#ffffff\",\n        fontFamily: uiConfig.fontFamily,\n        fontSize: game.config.width / 40\n      }\n    );\n    this.progressText.setOrigin(0.5);\n    this.load.on(\"progress\", this.onProgress, this);\n    // 場景加載的資源\n    this.load.image(\"bgTop\", \"./img/2nd-week5/bg_top.png\");\n    this.load.image(\"bgMiddle\", \"./img/2nd-week5/bg_middle.png\");\n    this.load.image(\"bgBottom\", \"./img/2nd-week5/bg_bottom.png\");\n    this.load.image(\"boss1\", \"./img/2nd-week5/boss1.png\");\n    this.load.image(\"boss2\", \"./img/2nd-week5/boss2.png\");\n    this.load.image(\"goal\", \"./img/2nd-week5/goal.png\");\n    this.load.image(\"superStar\", \"./img/2nd-week5/superStar.png\");\n    this.load.spritesheet(\"ballSprite\", \"./img/2nd-week5/ball_sprite.png\", {\n      frameWidth: 110,\n      frameHeight: 110\n    });\n    this.load.spritesheet(\"duckSprite\", \"./img/2nd-week5/duck_sprite.png\", {\n      frameWidth: 124,\n      frameHeight: 150\n    });\n    this.load.spritesheet(\n      \"btnLeftSprite\",\n      \"./img/2nd-week5/btnLeft_sprite.png\",\n      {\n        frameWidth: 50,\n        frameHeight: 55\n      }\n    );\n    this.load.spritesheet(\n      \"btnRightSprite\",\n      \"./img/2nd-week5/btnRight_sprite.png\",\n      {\n        frameWidth: 50,\n        frameHeight: 55\n      }\n    );\n    this.load.spritesheet(\"btnStart\", \"./img/2nd-week5/btnStart_sprite.png\", {\n      frameWidth: 150,\n      frameHeight: 55\n    });\n    this.load.spritesheet(\"clearSprite\", \"./img/2nd-week5/clear_sprite.png\", {\n      frameWidth: 190,\n      frameHeight: 155\n    });\n  }\n  create() {\n    // create event emitter\n    emitter = new Phaser.Events.EventEmitter();\n    // create emitter controler\n    controller = new Controller();\n    this.title = this.add.text(\n      game.config.width / 2,\n      game.config.height / 2 - 250,\n      \"90sec Game\",\n      {\n        color: \"#FDD23F\",\n        stroke: \"#F49C24\",\n        strokeThickness: 6,\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 72,\n        shadow: {\n          color: \"#9A7B5D\",\n          blur: 2,\n          fill: true,\n          offsetY: 5\n        }\n      }\n    );\n    this.title.setOrigin(0.5);\n    this.duck = this.add.sprite(\n      game.config.width / 2,\n      game.config.height / 2 - 110,\n      \"duckSprite\"\n    );\n    this.anims.create({\n      key: \"walk\",\n      frames: [\n        { key: \"duckSprite\", frame: 0 },\n        { key: \"duckSprite\", frame: 1 },\n        { key: \"duckSprite\", frame: 2 }\n      ],\n      frameRate: 8,\n      repeat: -1\n    });\n    this.duck.play(\"walk\");\n    this.btnStart = new FlatButton({\n      scene: this,\n      key: \"btnStart\",\n      text: \"開始遊戲\",\n      x: game.config.width / 2,\n      y: game.config.height / 2 + 100,\n      event: \"startGame\"\n    });\n    emitter.on(\"startGame\", this.startGame, this);\n  }\n  onProgress(val) {\n    this.progressText.setText(Math.floor(val * 100) + \"%\");\n  }\n  startGame() {\n    this.scene.start(\"SceneStart\");\n  }\n}\n\nclass SceneStart extends Phaser.Scene {\n  constructor() {\n    super(\"SceneStart\");\n  }\n  init() {\n    this.cursors = this.input.keyboard.createCursorKeys();\n    // 限制邊界在池塘中\n    this.physics.world.setBounds(\n      uiConfig.gridColWidth * 2,\n      uiConfig.gridColHeight * 1,\n      uiConfig.gridColWidth * 12,\n      uiConfig.gridColHeight * 4\n    );\n    this.cameras.main.setBounds(0, 0, game.config.width, game.config.height);\n  }\n  create() {\n    // gridSystem\n    var gridConfig = {\n      rows: 6,\n      cols: 16,\n      scene: this\n    };\n    alignGrid = new AlignGrid(gridConfig);\n\n    // create game objects\n    this.bgMiddle = this.add.image(\n      game.config.width / 2,\n      game.config.height / 2,\n      \"bgMiddle\"\n    );\n    this.bgBottom = new Wall({\n      scene: this,\n      x: game.config.width / 2,\n      y: game.config.height - 121,\n      key: \"bgBottom\",\n      origin: { x: 0.5, y: 0 }\n    });\n    this.bgTop = new Wall({\n      scene: this,\n      x: game.config.width / 2,\n      y: -121,\n      key: \"bgTop\",\n      origin: { x: 0.5, y: 0 }\n    });\n\n    this.ballGroup = this.physics.add.group();\n    this.superStarGroup = this.physics.add.group();\n\n    this.duck = this.physics.add.sprite(\n      game.config.width / 2,\n      game.config.height / 2 - 110,\n      \"duckSprite\"\n    );\n    this.duck.setCollideWorldBounds(true);\n    this.anims.create({\n      key: \"swim\",\n      frames: [\n        { key: \"duckSprite\", frame: 0 },\n        { key: \"duckSprite\", frame: 1 },\n        { key: \"duckSprite\", frame: 2 }\n      ],\n      frameRate: 3,\n      repeat: -1\n    });\n    this.duck.play(\"swim\");\n    this.anims.create({\n      key: \"rush\",\n      frames: [\n        { key: \"duckSprite\", frame: 3 },\n        { key: \"duckSprite\", frame: 4 },\n        { key: \"duckSprite\", frame: 5 }\n      ],\n      frameRate: 8,\n      repeat: -1\n    });\n\n    this.createTimeBoxCon();\n\n    // alignGrid.showNumbers();\n    alignGrid.placeAt(7, 4, this.duck);\n\n    // set Timer\n    this.countDownTimer = this.time.addEvent({\n      delay: 1000,\n      callback: this.checkCountDownTimer,\n      callbackScope: this,\n      repeat: 3\n    });\n\n    this.btnLeft = this.add.sprite(\n      game.config.width - 200,\n      game.config.height - 100,\n      \"btnLeftSprite\"\n    );\n\n    this.btnRight = this.add.sprite(\n      game.config.width - 145,\n      game.config.height - 100,\n      \"btnRightSprite\"\n    );\n  }\n  update() {\n    if (modal.isPlay) {\n      this.duck.body.velocity.x = 0;\n      if (this.cursors.left.isDown) {\n        this.duck.body.velocity.x = -modal.duckMoveSpeed;\n        this.btnLeft.setFrame(1);\n        this.btnLeft.y = game.config.height - 95;\n      } else if (this.cursors.right.isDown) {\n        this.duck.body.velocity.x = modal.duckMoveSpeed;\n        this.btnRight.setFrame(1);\n        this.btnRight.y = game.config.height - 95;\n      } else {\n        this.btnLeft.setFrame(0);\n        this.btnRight.setFrame(0);\n        this.btnLeft.y = game.config.height - 100;\n        this.btnRight.y = game.config.height - 100;\n      }\n      if (\n        this.boss1 &&\n        this.boss1.y > game.config.height + this.boss1.height / 2\n      ) {\n        this.boss1.setActive(false);\n        this.boss1.setVisible(false);\n        this.boss1.destroy();\n      }\n      if (\n        this.boss2 &&\n        this.boss2.y > game.config.height + this.boss2.height / 2\n      ) {\n        this.boss2.setActive(false);\n        this.boss2.setVisible(false);\n        this.boss2.destroy();\n      }\n      this.ballGroup.children.iterate(function(ball) {\n        if (ball && ball.y > game.config.height + ball.height / 2) {\n          ball.setActive(false);\n          ball.setVisible(false);\n          ball.destroy();\n        }\n      }, this);\n      this.superStarGroup.children.iterate(function(star) {\n        if (star && star.y > game.config.height + star.height / 2) {\n          star.setActive(false);\n          star.setVisible(false);\n          star.destroy();\n        }\n      }, this);\n      this.physics.add.collider(\n        this.duck,\n        this.ballGroup,\n        this.hitTheBall.bind(this)\n      );\n      this.physics.add.collider(\n        this.duck,\n        this.boss1,\n        this.hitTheBoss.bind(this)\n      );\n      this.physics.add.collider(\n        this.duck,\n        this.boss2,\n        this.hitTheBoss.bind(this)\n      );\n      this.physics.add.overlap(\n        this.duck,\n        this.superStarGroup,\n        this.hitTheSuperStar.bind(this)\n      );\n    }\n  }\n  checkGameTime() {\n    if (this.countDueTimer) {\n      const elapsedTime = uiConfig.gameTime - modal.gameDueTime;\n      if (elapsedTime >= 0) {\n        let minute = \"0\" + Math.floor(elapsedTime / 60);\n        let second = (elapsedTime - minute * 60).toString();\n        second = second.length === 2 ? second : \"0\" + second;\n        this.timeText.setText(`${minute}:${second}`);\n      } else {\n        this.countDueTimer.remove();\n        modal.isPlay = false;\n      }\n    }\n  }\n  checkCountDownTimer() {\n    if (this.countDownText) {\n      this.countDownText.destroy();\n    }\n    this.countDownText = this.add.text(\n      game.config.width / 2,\n      game.config.height / 2,\n      this.countDownTimer.getRepeatCount(),\n      {\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 150\n      }\n    );\n    this.countDownText.setOrigin(0.5);\n    if (this.countDownTimer.getRepeatCount() === 0) {\n      this.countDownText.destroy();\n      this.countDueTimer = this.time.addEvent({\n        delay: 1000,\n        callback: this.checkCountDueTimer,\n        callbackScope: this,\n        repeat: uiConfig.gameTime\n      });\n      modal.isPlay = true;\n      this.tweens.add({\n        targets: this.bgBottom,\n        duration: 1000,\n        y: game.config.height\n      });\n      this.fireBall();\n    }\n  }\n  checkCountDueTimer() {\n    if (modal.isPlay) {\n      // console.log(this.ballGroup.getChildren());\n      modal.gameDueTime++;\n      if (\n        modal.gameDueTime % modal.fireBallTime === 0 &&\n        modal.gameDueTime < 80\n      ) {\n        this.fireBall();\n      }\n      if (modal.gameDueTime % 5 === 0 && modal.gameDueTime < 80) {\n        this.fireSuperStar();\n      }\n      if (modal.gameDueTime === 50) {\n        this.fireBoss1();\n      }\n      if (modal.gameDueTime === 80) {\n        this.fireBoss2();\n      }\n      if (modal.gameDueTime === 88) {\n        this.tweens.add({\n          targets: this.bgTop,\n          duration: 1000,\n          y: 0\n        });\n        this.endGame();\n      }\n      this.checkGameTime();\n    }\n  }\n  checkBecomeSuperTimer() {\n    if (this.becomeSuperTimer.getRepeatCount() === 0) {\n      this.duck.anims.stop();\n      this.duck.play(\"swim\");\n      modal.duckMoveSpeed = 150;\n    }\n  }\n  createTimeBoxCon() {\n    this.timeBox = this.add.graphics();\n    this.timeBox.fillStyle(0x535353);\n    this.timeBox.fillRoundedRect(\n      0,\n      10,\n      uiConfig.gridColWidth * 3,\n      uiConfig.gridColHeight,\n      30\n    );\n    this.timeBox.fillStyle(0x000000);\n    this.timeBox.fillRoundedRect(\n      0,\n      0,\n      uiConfig.gridColWidth * 3,\n      uiConfig.gridColHeight,\n      30\n    );\n    this.subTimeText = this.add.text(uiConfig.gridColWidth / 2, 40, \"TIME\", {\n      fontFamily: uiConfig.fontFamily,\n      fontSize: 20\n    });\n    this.timeText = this.add.text(\n      uiConfig.gridColWidth + uiConfig.gridColWidth / 2,\n      uiConfig.gridColHeight - 50,\n      \"01:30\",\n      {\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 60\n      }\n    );\n    this.timeText.setOrigin(0.5);\n    this.timeBoxCon = this.add.container();\n    this.timeBoxCon.add(this.timeBox);\n    this.timeBoxCon.add(this.subTimeText);\n    this.timeBoxCon.add(this.timeText);\n    this.timeBoxCon.x = uiConfig.gridColWidth * 13;\n    this.timeBoxCon.y = -20;\n  }\n  endGame() {\n    this.goal = this.add.image(0, 0, \"goal\");\n    alignGrid.placeAt(8, 1, this.goal);\n    this.goal.setScale(0);\n    this.goal.opacity = 0;\n    this.tweens.add({\n      targets: this.goal,\n      duration: 1000,\n      delay: 1000,\n      scale: 1,\n      opacity: 1\n    });\n    this.tweens.add({\n      targets: this.duck,\n      duration: 1500,\n      delay: 2500,\n      x: 650,\n      y: 370\n    });\n    setTimeout(() => {\n      this.gameOverScreen = new GameOverScreen({\n        scene: this,\n        x: game.config.width / 2,\n        y: game.config.height / 2,\n        title: \"Congratulations! 恭喜過關!\",\n        btnText: \"再來一次..\",\n        gameSuccess: true\n      });\n      for (let i = 1; i <= 3; i++) {\n        this.tweens.add({\n          targets: this.gameOverScreen[`clear${i}`],\n          duration: 1500,\n          delay: i * 500,\n          alpha: 1\n        });\n      }\n    }, 4200);\n  }\n  fireBall() {\n    let ball = this.ballGroup.getFirstDead(false);\n    if (!ball) {\n      ball = this.ballGroup.create(0, 0, \"ballSprite\");\n    }\n    alignGrid.placeAt(getRandomColumn(), 0, ball);\n    ball.y = -uiConfig.gridColHeight / 2;\n    ball.setImmovable();\n    ball.setFrame(Math.floor(Math.random() * 4));\n    ball.setActive(true);\n    ball.setVisible(true);\n    ball.setVelocityY(modal.objSpeed);\n  }\n  fireBoss1() {\n    this.boss1 = this.physics.add.sprite(0, 0, \"boss1\");\n    alignGrid.placeAt(getRandomColumn(), 0, this.boss1);\n    this.boss1.setImmovable();\n    this.boss1.setActive(true);\n    this.boss1.setVisible(true);\n    this.boss1.setVelocityY(modal.objSpeed);\n  }\n  fireBoss2() {\n    this.boss2 = this.physics.add.sprite(0, 0, \"boss2\");\n    alignGrid.placeAt(getRandomColumn(), 0, this.boss2);\n    this.boss2.setImmovable();\n    this.boss2.setActive(true);\n    this.boss2.setVisible(true);\n    this.boss2.setVelocityY(modal.objSpeed);\n  }\n  fireSuperStar() {\n    let superStar = this.superStarGroup.getFirstDead(false);\n    if (!superStar) {\n      superStar = this.superStarGroup.create(0, 0, \"superStar\");\n    }\n    alignGrid.placeAt(getRandomColumn(), 0, superStar);\n    superStar.y = -uiConfig.gridColHeight / 2;\n    superStar.setImmovable();\n    superStar.setActive(true);\n    superStar.setVisible(true);\n    superStar.setVelocityY(modal.objSpeed);\n  }\n  hitTheBall(duck, ball) {\n    if (modal.isPlay) {\n      modal.isPlay = false;\n      this.ballGroup.setVelocityY(0);\n      this.superStarGroup.setVelocityY(0);\n      if (this.boss1 && this.boss1.body) {\n        this.boss1.setVelocityY(0);\n      }\n      if (this.boss2 && this.boss2.body) {\n        this.boss2.setVelocityY(0);\n      }\n      this.duck.anims.stop();\n      this.duck.setFrame(6);\n      duck.body.velocity.x = 0;\n      this.gameOverScreen = new GameOverScreen({\n        scene: this,\n        x: game.config.width / 2,\n        y: game.config.height / 2,\n        title: \"UH-OH! 觸礁了\",\n        subTitle: \"勝敗乃鴨家常事，大俠重新來過吧~\",\n        btnText: \"重新挑戰\",\n        gameSuccess: false\n      });\n    }\n  }\n  hitTheBoss(duck, boss) {\n    if (modal.isPlay) {\n      modal.isPlay = false;\n      boss.setVelocityY(0);\n      this.ballGroup.setVelocityY(0);\n      this.superStarGroup.setVelocityY(0);\n      this.duck.anims.stop();\n      this.duck.setFrame(6);\n      duck.body.velocity.x = 0;\n      this.gameOverScreen = new GameOverScreen({\n        scene: this,\n        x: game.config.width / 2,\n        y: game.config.height / 2,\n        title: \"UH-OH! 觸礁了\",\n        subTitle: \"勝敗乃鴨家常事，大俠重新來過吧~\",\n        btnText: \"重新挑戰\",\n        gameSuccess: false\n      });\n    }\n  }\n  hitTheSuperStar(duck, star) {\n    if (modal.isPlay) {\n      this.duck.anims.stop();\n      this.duck.play(\"rush\");\n      modal.duckMoveSpeed = 300;\n      this.tweens.add({\n        targets: star,\n        duration: 500,\n        opacity: 0\n      });\n      this.killSprite(\"ballGroup\");\n      this.killSprite(\"superStarGroup\");\n      if (this.boss1) {\n        this.boss1.body = null;\n        this.boss1.destroy();\n      }\n      if (this.boss2) {\n        this.boss2.body = null;\n        this.boss2.destroy();\n      }\n      this.becomeSuperTimer = this.time.addEvent({\n        delay: 1000,\n        callback: this.checkBecomeSuperTimer,\n        callbackScope: this,\n        repeat: 3\n      });\n    }\n  }\n  killSprite(groupName) {\n    this[groupName].getChildren().map(child => child.destroy());\n  }\n}\n\n// btn class\nclass FlatButton extends Phaser.GameObjects.Container {\n  constructor(config) {\n    if (!config.scene) {\n      return;\n    }\n    super(config.scene);\n    this.scene = config.scene;\n    this.config = config;\n    this.btn = this.scene.add.sprite(0, 0, config.key);\n    this.add(this.btn);\n    if (config.text) {\n      this.text = this.scene.add.text(0, 0, config.text, {\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 30\n      });\n      this.text.setOrigin(0.5);\n      this.add(this.text);\n    }\n    if (config.x) {\n      this.x = config.x;\n    }\n    if (config.y) {\n      this.y = config.y;\n    }\n    if (config.event) {\n      this.btn.setInteractive({ cursor: \"pointer\" });\n      this.btn.on(\"pointerdown\", this.onPointerdown, this);\n      this.btn.on(\"pointerup\", this.onPointerup, this);\n    }\n    this.scene.add.existing(this);\n  }\n  onPointerdown() {\n    this.btn.setFrame(1);\n    this.y += 5;\n  }\n  onPointerup() {\n    this.btn.setFrame(0);\n    this.y -= 5;\n    emitter.emit(this.config.event);\n  }\n}\n\n// wall class\nclass Wall extends Phaser.GameObjects.Container {\n  constructor(config) {\n    if (!config.scene) {\n      return;\n    }\n    super(config.scene);\n    this.scene = config.scene;\n    this.config = config;\n    this.wall = this.scene.add.image(0, 0, config.key);\n    this.graphics = this.scene.add.graphics();\n    this.graphics.fillStyle(0x000000);\n    this.graphics.fillRect(\n      -game.config.width,\n      0,\n      game.config.width + game.config.width / 2,\n      121\n    );\n    this.add(this.graphics);\n    this.add(this.wall);\n    if (config.x) {\n      this.x = config.x;\n    }\n    if (config.y) {\n      this.y = config.y;\n    }\n    if (config.origin) {\n      const { x, y } = config.origin;\n      this.wall.setOrigin(x, y);\n    }\n    this.scene.add.existing(this);\n  }\n  onPointerdown() {\n    this.btn.setFrame(1);\n    this.y += 5;\n  }\n  onPointerup() {\n    this.btn.setFrame(0);\n    emitter.emit(this.config.event);\n  }\n}\n\n// gameOver class\nclass GameOverScreen extends Phaser.GameObjects.Container {\n  constructor(config) {\n    if (!config.scene) {\n      return;\n    }\n    super(config.scene);\n    this.scene = config.scene;\n    this.config = config;\n    this.graphics = this.scene.add.graphics();\n    this.graphics.fillStyle(0x000000, 0.5);\n    this.graphics.fillRect(\n      -game.config.width / 2,\n      -game.config.height / 2,\n      game.config.width,\n      game.config.height\n    );\n    this.graphics.fillStyle(0xffffff);\n    this.graphics.fillRoundedRect(\n      0 - uiConfig.gridColWidth * 4,\n      0 - uiConfig.gridColHeight,\n      uiConfig.gridColWidth * 8,\n      uiConfig.gridColHeight * 2,\n      30\n    );\n    this.add(this.graphics);\n    if (config.gameSuccess) {\n      this.title = this.scene.add.text(0, -110, config.title, {\n        color: \"#ff952b\",\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 36\n      });\n    } else {\n      this.title = this.scene.add.text(0, -60, config.title, {\n        color: \"#ff952b\",\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 36\n      });\n    }\n    this.title.setOrigin(0.5);\n    this.add(this.title);\n    if (config.gameSuccess) {\n      this.clear1 = this.scene.add.sprite(-200, 0, \"clearSprite\", 0);\n      this.clear2 = this.scene.add.sprite(0, 0, \"clearSprite\", 1);\n      this.clear3 = this.scene.add.sprite(200, 0, \"clearSprite\", 2);\n      this.clear1.alpha = 0;\n      this.clear2.alpha = 0;\n      this.clear3.alpha = 0;\n      this.add(this.clear1);\n      this.add(this.clear2);\n      this.add(this.clear3);\n    } else {\n      this.subTitle = this.scene.add.text(0, -10, config.subTitle, {\n        color: \"#707070\",\n        fontFamily: uiConfig.fontFamily,\n        fontSize: 20\n      });\n      this.subTitle.setOrigin(0.5);\n      this.add(this.subTitle);\n    }\n    if (config.gameSuccess) {\n      this.btnRestart = new FlatButton({\n        scene: config.scene,\n        key: \"btnStart\",\n        text: config.btnText,\n        x: 0,\n        y: 110,\n        event: \"restartGame\"\n      });\n    } else {\n      this.btnRestart = new FlatButton({\n        scene: config.scene,\n        key: \"btnStart\",\n        text: config.btnText,\n        x: 0,\n        y: 50,\n        event: \"restartGame\"\n      });\n    }\n    this.add(this.btnRestart);\n    if (config.x) {\n      this.x = config.x;\n    }\n    if (config.y) {\n      this.y = config.y;\n    }\n    this.scene.add.existing(this);\n  }\n  onPointerdown() {\n    this.btn.setFrame(1);\n    this.y += 5;\n  }\n  onPointerup() {\n    this.btn.setFrame(0);\n    emitter.emit(this.config.event);\n  }\n}\n\n// gridSystem\nclass AlignGrid {\n  constructor(config) {\n    if (!config.scene) {\n      return;\n    }\n    this.config = config;\n    this.config.row = config.rows || 6;\n    this.config.cols = config.cols || 5;\n    this.config.width = config.width || game.config.width;\n    this.config.height = config.height || game.config.height;\n\n    this.scene = config.scene;\n    this.cw = this.config.width / this.config.cols;\n    this.ch = this.config.height / this.config.rows;\n  }\n  show() {\n    this.graphics = this.scene.add.graphics();\n    this.graphics.lineStyle(2, 0x00ff00);\n    for (let i = 0; i < this.config.width; i += this.cw) {\n      this.graphics.moveTo(i, 0);\n      this.graphics.lineTo(i, this.config.height);\n    }\n    for (let i = 0; i < this.config.height; i += this.ch) {\n      this.graphics.moveTo(0, i);\n      this.graphics.lineTo(this.config.width, i);\n    }\n    this.graphics.strokePath();\n  }\n  placeAt(xx, yy, obj) {\n    obj.x = this.cw * xx + this.cw / 2;\n    obj.y = this.ch * yy + this.ch / 2;\n  }\n  placeAtIndex(index, obj) {\n    // 另一種指定位置的方式，以格數來指定\n    var xx = index % this.cols;\n    var yy = Math.floor(index / this.cols);\n    this.placeAt(xx, yy, obj);\n  }\n  showNumbers() {\n    // 在每一格中呈現當前的 index 數字\n    this.show();\n    var count = 0;\n    for (var i = 0; i < this.config.rows; i++) {\n      for (var j = 0; j < this.config.cols; j++) {\n        var numText = this.scene.add.text(0, 0, count, \"#00ff00\");\n        numText.setOrigin(0.5, 0.5);\n        this.placeAtIndex(count, numText);\n        count++;\n      }\n    }\n  }\n}\n\nfunction getRandomColumn() {\n  return Math.floor(Math.random() * 10) + 3;\n}\n"]}