{"version":3,"sources":["crypto-pay.js"],"names":["vm","formProfile","name","mobile","email","date","nop","child","comment","code","agree","cardNumber","formPayment","cardNumberInput","expiredMonth","$","Vue","use","VeeValidate","classes","classNames","el","data","progress","steps","currentStep","profile","payment","payby","formPayby","isMobile","methods","computed","stepName","_this","this","$validator","validateAll","then","result","console","removeClass","addClass","setTimeout","resetForm","formName","JSON","parse","stringify","reset","checkCardNumberInput","number","index","length","$refs","focus","resetAllStep","key","initFormData","formatCreditNumber","e","valArr","target","value","replace","split","temp","map","val","i","push","join","created","_this2","extend","validate","adult","mounted","timer","on","window","width","clearTimeout","animate","scrollTop","attr"],"mappings":"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","file":"crypto-pay.js","sourcesContent":["let vm = null;\r\nconst formProfile = {\r\n  name: null,\r\n  mobile: null,\r\n  email: null,\r\n  date: \"2019/08/09\",\r\n  nop: {\r\n    adult: 0,\r\n    child: 0\r\n  },\r\n  code: null,\r\n  comment: null,\r\n  agree: false\r\n};\r\nconst formPayment = {\r\n  name: null,\r\n  cardNumber: [\"\", \"\", \"\", \"\"],\r\n  cardNumberInput: null,\r\n  expiredMonth: null,\r\n  expiredYear: null,\r\n  cvv: null\r\n};\r\n\r\n$(function() {\r\n  // 表單驗證 plugin\r\n  Vue.use(VeeValidate, {\r\n    classes: true,\r\n    classNames: {\r\n      valid: \"is-valid\",\r\n      invalid: \"is-invalid\"\r\n    }\r\n  });\r\n  vm = new Vue({\r\n    el: \"#app\",\r\n    data: {\r\n      progress: {\r\n        steps: [\"profile\", \"payby\", \"payment\"],\r\n        currentStep: 0,\r\n        profile: false,\r\n        payby: false,\r\n        payment: false\r\n      },\r\n      payby: [\"超商代碼 7-11\", \"ATM轉帳\", \"街口支付\", \"信用卡\", \"LINE Pay\"],\r\n      formProfile: null,\r\n      formPayby: null,\r\n      formPayment: null,\r\n      hideOrder: true,\r\n      isMobile: false\r\n    },\r\n    computed: {},\r\n    methods: {\r\n      validateBeforeSubmit(stepName) {\r\n        this.$validator.validateAll().then(result => {\r\n          console.log(\"work\");\r\n          console.log(result);\r\n          if (result) {\r\n            this.progress[stepName] = true;\r\n            this.progress.currentStep++;\r\n            return;\r\n          }\r\n          if (stepName === \"payby\") {\r\n            $(\".alert_payby\")\r\n              .removeClass(\"hide\")\r\n              .addClass(\"show\");\r\n            setTimeout(() => {\r\n              $(\".alert_payby\")\r\n                .removeClass(\"show\")\r\n                .addClass(\"hide\");\r\n            }, 2000);\r\n          }\r\n        });\r\n      },\r\n      resetForm(formName) {\r\n        switch (formName) {\r\n          case \"formProfile\":\r\n            this.formProfile = JSON.parse(JSON.stringify(formProfile));\r\n            this.$validator.reset();\r\n            return;\r\n          case \"formPayby\":\r\n            this.formPayby = null;\r\n            this.progress.profile = false;\r\n            this.progress.currentStep--;\r\n            return;\r\n          case \"formPayment\":\r\n            this.formPayment = JSON.parse(JSON.stringify(formPayment));\r\n            this.progress.payby = false;\r\n            this.progress.currentStep--;\r\n            return;\r\n          default:\r\n            return;\r\n        }\r\n      },\r\n      checkCardNumberInput(number, index) {\r\n        if (number.length === 4 && index < 3) {\r\n          this.$refs.cardNumber[index + 1].focus();\r\n        }\r\n      },\r\n      resetAllStep() {\r\n        console.log(\"work\");\r\n        for (let key in this.progress) {\r\n          if (key === \"steps\") continue;\r\n          if (key === \"currentStep\") {\r\n            this.progress[key] = 0;\r\n            continue;\r\n          }\r\n          this.progress[key] = false;\r\n        }\r\n        this.initFormData();\r\n      },\r\n      initFormData() {\r\n        this.formProfile = JSON.parse(JSON.stringify(formProfile));\r\n        this.formPayby = null;\r\n        this.formPayment = JSON.parse(JSON.stringify(formPayment));\r\n      },\r\n      formatCreditNumber(e) {\r\n        let val = e.target.value.replace(/-/g, \"\");\r\n        let valArr = val.split(\"\");\r\n        let temp = [];\r\n        valArr.map((val, i) => {\r\n          temp.push(val);\r\n          if ((i + 1) % 4 === 0 && temp.length < 19) {\r\n            temp.push(\"-\");\r\n          }\r\n        });\r\n        this.formPayment.cardNumberInput = temp.join(\"\");\r\n      }\r\n    },\r\n    created() {\r\n      // 參加人數的客製化驗證\r\n      this.$validator.extend(\"nop\", {\r\n        validate: () => {\r\n          return this.formProfile.nop.adult + this.formProfile.nop.child > 0;\r\n        }\r\n      });\r\n      this.initFormData();\r\n    },\r\n    mounted() {\r\n      let timer = null;\r\n      $(window).on(\"scroll\", () => {\r\n        if ($(window).width() <= 767) {\r\n          clearTimeout(timer);\r\n          timer = setTimeout(() => {\r\n            $(\".popup_wrapper\").animate(\r\n              {\r\n                top: $(window).scrollTop()\r\n              },\r\n              300\r\n            );\r\n          }, 100);\r\n        } else {\r\n          $(\".popup_wrapper\").attr(\"style\", \"\");\r\n        }\r\n      });\r\n      $(window).on(\"resize\", () => {\r\n        this.isMobile = $(window).width() <= 575 ? true : false;\r\n      });\r\n    }\r\n  });\r\n});\r\n"]}